!function(){"use strict";function a(a,b){for(var a=void 0;a&&a.tagName&&a.tagName!==b.toUpperCase();)a=a.previousSibling();return a}function b(b){this.defaults={context:document.body},this.buttons=void 0,this.commands=void 0,this.setButtons=function(){var a="button"===this.options.context.tagName.toLowerCase();this.buttons=a?[this.options.context]:this.options.context.getElementsByTagName("button")},this.setCommands=function(){this.commands=this.options.context.querySelectorAll("menu a, menu menuitem, menu button")},this.getMenu=function(a){return document.getElementById(a.getAttribute("menu"))},this.getButton=function(a){return this.options.context.querySelector('[menu="'+a.id+'"]')},this.getParentMenu=function(a){for(;a;){if("menu"===a.tagName.toLowerCase())return a;a=a.parentNode}return null},this.toggle=function(a,b,c){var d=null!==b,e=d&&!b.hasAttribute("hidden");c=void 0===c||c,e?this.hide(a,b):c&&this.show(a,b)},this.hide=function(a,b){var c=null!==b;a.removeAttribute("open"),c&&b.setAttribute("hidden","")},this.show=function(a,b){var c=null!==b;a.setAttribute("open",""),c&&b.removeAttribute("hidden")},this.hasAncestorButton=function(b){return void 0!==a(b.target,"button")},this.hasAncestorMenu=function(b){return void 0!==a(b.target,"menu")},this.addHandlerButtonClick=function(){var a,b,c,d,e=this;for(c=0,d=this.buttons.length;c<d;c++)a=this.buttons[c],b=this.getMenu(a),null!==b&&a.addEventListener("click",function(a){e.handleButtonClick(this,a)})},this.addHandlerCommandClick=function(){var a,b,c,d=this;for(b=0,c=this.commands.length;b<c;b++)a=this.commands[b],a.addEventListener("click",function(a){d.handleCommandClick(this,a)})},this.addHandlerDocumentClick=function(){var a=this;document.addEventListener("click",function(b){a.handleDocumentClick(this,b)})},this.handleButtonClick=function(a,b){var c=this.getMenu(a);!this.hasAncestorMenu(b)&&(this.toggle(a,c),b.stopPropagation())},this.handleCommandClick=function(a,b){var c=this.getParentMenu(a),d=null!==c,e=this.getButton(c);d&null!==e&&this.toggle(e,c,!1)},this.handleDocumentClick=function(a,b){var c,d,e,f,g=this.hasAncestorButton(b),h=this.hasAncestorMenu(b),i=!g&&!h;if(i)for(f=0,e=this.buttons.length;f<e;f++)c=this.buttons[f],d=this.getMenu(c),this.toggle(c,d,!1)},this.validateOptions=function(){var a,b;for(a in this.options){b=this.options[a];var c=b instanceof HTMLElement,d=b&&b.jquery;switch(a){case"context":if(!c&&!d)return console.warn("validateOptions: Property `"+a+"` is not an HTMLElement.",warn),!1;this.options[a]=d?b[0]:b}}return!0},this.init=function(a){if(this.options=this.defaults,!this.validateOptions())return!1;this.setButtons(),this.setCommands(),this.addHandlerButtonClick(),this.addHandlerCommandClick(),this.addHandlerDocumentClick()},this.init(b)}new b}();